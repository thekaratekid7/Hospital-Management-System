Imports System.Data.SqlClient
Imports System.DBNull

Public Class AddRecord
    Dim insertQuery As String
    Dim connection As New SqlConnection("Server= DESKTOP-STMQUHM; Database = HospitalDB;Trusted_Connection=True")

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click


        Dim insertQuery = "insert into Patient_details(PatName,MobNum,District,Nationality,Age,Gender,Disease)VALUES(@PatName, @MobNum, @District, @Nationality, @Age, @Gender, @Disease)"
        Dim com As New SqlCommand(insertQuery, connection)
        com.Parameters.Add("@PatName", SqlDbType.VarChar).Value = TextBox1.Text
        com.Parameters.Add("@MobNum", SqlDbType.VarChar).Value = TextBox2.Text
        com.Parameters.Add("@District", SqlDbType.VarChar).Value = TextBox3.Text
        com.Parameters.Add("@Nationality", SqlDbType.VarChar).Value = DBNull.Value
        com.Parameters.Add("@Age", SqlDbType.Int).Value = TextBox5.Text.ToString
        com.Parameters.Add("@Gender", SqlDbType.VarChar).Value = DBNull.Value
        com.Parameters.Add("@Disease", SqlDbType.VarChar).Value = TextBox4.Text
        Try
            connection.Open()
            com.ExecuteNonQuery()
            MessageBox.Show("Data Inserted")

        Catch ex As Exception
            MessageBox.Show(ex.Message)
        End Try

        connection.Close()



        ' End Using

        '; Intergrated Security= true
        'Dim insertQuery As String = 
        'insertQuery="insert into Patient_details(PatName,HouseName,District,Disease)VALUES('" & TextBox1.Text& "','" & TextBox2.Text& "','" & TextBox3.Text& "',"& TextBox8.Text& ")",connection
        'ExecuteQuery(insertQuery)
        'MessageBox.Show("Data Inserted")


        ' Dim con As New OleDb.OleDbConnection  
        'Dim ds As New DataSet
        'Dim da As OleDb.OleDbDataAdapter
        'Dim sql As String
        'con.ConnectionString = _
        '    "Provider=Microsoft.ACE.OLEDB.12.0; Data Source=C:\Users\butterfly\Documents\HMS.accdb;Persist Security Info=False;"
        'con.Open()
        'MsgBox("A connection to the database is now open.")
        'sql = "SELECT * FROM Patient_details"
        'da = New OleDb.OleDbDataAdapter(sql, con)


    End Sub


    Private Sub VBNET_ListBox_Items_From_SQL_Load(ByVal sender As Object, ByVal e As EventArgs) Handles MyBase.Load

        ListBox2.Items.Add("Male")
        ListBox2.Items.Add("Female")

        ListBox1.Items.Add("Afghanistan")
        ListBox1.Items.Add("Albania")
        ListBox1.Items.Add("Australia")
        ListBox1.Items.Add("Bahamas")
        ListBox1.Items.Add("Bangladesh")
        ListBox1.Items.Add("Belgium")
        ListBox1.Items.Add("Bhutan")
        ListBox1.Items.Add("Brazil")
        ListBox1.Items.Add("China")
        ListBox1.Items.Add("Croatia")
        ListBox1.Items.Add("Cuba")
        ListBox1.Items.Add("Denmark")
        ListBox1.Items.Add("Egypt")
        ListBox1.Items.Add("Finland")
        ListBox1.Items.Add("France")
        ListBox1.Items.Add("Germany")
        ListBox1.Items.Add("Hungary")
        ListBox1.Items.Add("India")
        ListBox1.Items.Add("Indonesia")
        ListBox1.Items.Add("Iraq")
        ListBox1.Items.Add("Ireland")
        ListBox1.Items.Add("Japan")
        ListBox1.Items.Add("Kenya")
        ListBox1.Items.Add("Kuwait")
        ListBox1.Items.Add("Malaysia")
        ListBox1.Items.Add("Morocco")
        ListBox1.Items.Add("New Zealand")
        ListBox1.Items.Add("Oman")
        ListBox1.Items.Add("Pakistan")
        ListBox1.Items.Add("Poland")
        ListBox1.Items.Add("Russia")
        ListBox1.Items.Add("Singapore")
        ListBox1.Items.Add("South Korea")
        ListBox1.Items.Add("Switzerland")
        ListBox1.Items.Add("Turkey")
        ListBox1.Items.Add("Ukraine")
        ListBox1.Items.Add("Yemen")
        ListBox1.Items.Add("Zimbabwe")


        ListBox3.Items.Add("A+")
        ListBox3.Items.Add("A-")
        ListBox3.Items.Add("B+")
        ListBox3.Items.Add("B-")
        ListBox3.Items.Add("O+")
        ListBox3.Items.Add("O-")
        ListBox3.Items.Add("AB+")
        ListBox3.Items.Add("AB-")




        'Dim command1 As New SqlCommand("select * from Gender_table")
        'command1.Connection = connection

        'Dim adapter1 As New SqlDataAdapter(command1)
        'Dim table1 As New DataTable()

        'adapter1.Fill(table1)


        'ListBox2.DataSource = table1

        'ListBox2.DisplayMember = "Gender"
        'ListBox2.ValueMember = "Gender"
    End Sub




    '  Public Sub ExecuteQuery(ByVal query As String)
    'Dim command As New SqlCommand(query, connection)
    '   connection.Open()
    '
    '   command.ExecuteNonQuery()

    '  connection.Close()
    'End Sub


    'Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

    'End Sub

    'Private Sub Button3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button3.Click
    '    Form1.Show()
    'End Sub

    'Private Sub Button2_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs)
    '    ListBox1.Items.Remove(ListBox1.SelectedItem)
    'End Sub

    'Private Sub Button4_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button4.Click
    '    TextBox1.Clear()
    '    TextBox2.Clear()
    '    TextBox3.Clear()
    '    TextBox4.Clear()

    'End Sub

    'Private Sub NumericUpDown1_ValueChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NumericUpDown1.ValueChanged

    'End Sub

    'Private Sub Button2_Click_2(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click
    '    ListBox2.Items.Add(TextBox1.Text)

    'End Sub
End Class